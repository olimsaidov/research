# Маълумотлар оқими диаграммаси

## Умумий кўриниш
Бу диаграмма Jarima платформаси орқали маълумотларнинг тўлиқ оқимини тасвирлайди, бошланғич қоидабузарликни ушлашдан то охирги мукофот тарқатишгача. У маълумотлар қандай ўзгариши ва турли қайта ишлаш босқичлари орқали ҳаракатланишини, ҳар бир босқичда қиймат яратишини кўрсатади.

## Асосий маълумотлар оқими

```mermaid
flowchart TB
    subgraph "Маълумотларни ушлаш"
        VR[Қоидабузарликни ёзиб олиш<br/>- Видео: 2-120 сония<br/>- GPS жойлашуви<br/>- Вақт белгиси]
        MD[Метамаълумотлар<br/>- Қурилма маълумоти<br/>- Фойдаланувчи контексти<br/>- Тармоқ маълумотлари]
    end

    subgraph "Дастлабки қайта ишлаш"
        VU[Видео юклаш<br/>- Формат текшируви<br/>- Ҳажм текшируви<br/>- Такрорланишни аниқлаш]
        TG[Миниатюра яратиш<br/>- 1 сония офсетни ажратиш<br/>- Тасвир оптимизацияси<br/>- Сақлаш]
    end

    subgraph "AI қайта ишлаш қувури"
        EQ[Кодлаш навбати<br/>- Устуворлик бошқаруви<br/>- Ишончга асосланган ўтказиб юбориш<br/>- 60 сония тикер]
        ES[Кодлаш хизмати<br/>- Формат стандартлаштириш<br/>- 60% сиқиш<br/>- Сифат оптимизацияси]
        DQ[Аниқлаш навбати<br/>- Мажбурий устуворлик<br/>- Хронологик тартиб<br/>- 100 сония тикер]
        DS[Аниқлаш хизмати<br/>- Қоидабузарликни аниқлаш<br/>- Рақам белгисини OCR<br/>- Ишонч баллари]
    end

    subgraph "Инсон кўриб чиқиши"
        RD[Кўриб чиқиш панели<br/>- Видео ижро<br/>- AI натижалари<br/>- Қарор қабул қилиш воситалари]
        VI[Қоидабузарлик киритиш<br/>- Рақам белгиси<br/>- Модда танлаш<br/>- Далил белгилаш]
        DM[Қарор қабул қилиш<br/>- Қабул/Рад этиш<br/>- ASBTга юбориш<br/>- Қўшимча маълумот сўраш]
    end

    subgraph "Интеграция қатлами"
        ASF[ASBT форматлаш<br/>- Маълумотларни қадоқлаш<br/>- Тасвир кодлаш<br/>- API мувофиқлиги]
        ASI[ASBT интеграцияси<br/>- Токен аутентификацияси<br/>- Хавфсиз узатиш<br/>- Ҳолат синхронизацияси]
        WH[Webhook жўнатиш<br/>- Воқеа триггерлари<br/>- Мижоз хабарномаси<br/>- Қайта уриниш мантиғи]
    end

    subgraph "Тўлов қайта ишлаш"
        RC[Мукофот ҳисоблаш<br/>- Модда омили<br/>- Чегаралар текшируви<br/>- Фирибгарликни аниқлаш]
        PQ[Тўлов навбати<br/>- Пакет гуруҳлаш<br/>- Провайдер йўналиши<br/>- Устуворлик тартиби]
        PD[Тўлов жўнатиш<br/>- Kash интеграцияси<br/>- UzCard ўтказмаси<br/>- Ҳолатни кузатиш]
    end

    subgraph "Маълумотларни сақлаш"
        subgraph "PostgreSQL"
            UD[Фойдаланувчи маълумотлари<br/>- Профиллар<br/>- Аутентификация маълумоти<br/>- Афзалликлар]
            RData[Ҳисобот маълумотлари<br/>- Ҳолат<br/>- Вақт белгилари<br/>- Муносабатлар]
            VData[Қоидабузарлик маълумотлари<br/>- Тафсилотлар<br/>- Қарорлар<br/>- Далиллар]
            TData[Транзакция маълумотлари<br/>- Тўловлар<br/>- Мукофотлар<br/>- Аудит изи]
        end
        
        subgraph "MinIO сақлаш"
            VOrig[Асл видеолар<br/>- Хом юклаш<br/>- Метамаълумотлар]
            VEnc[Кодланган видеолар<br/>- Сиқилган<br/>- Стандартлашган]
            VDet[Аниқлаш видеолари<br/>- AI қопламалар<br/>- Изоҳлар]
            IMG[Тасвирлар<br/>- Миниатюралар<br/>- Далиллар<br/>- Рақам кесимлари]
        end
        
        subgraph "Redis кеш"
            SES[Сессиялар<br/>- Фойдаланувчи аутентификацияси<br/>- Вақтинчалик токенлар]
            CAC[Кеш маълумотлари<br/>- Тез-тез сўровлар<br/>- API жавоблари]
            QST[Навбат ҳолати<br/>- Қайта ишлаш ҳолати<br/>- Устуворликлар]
        end
    end

    subgraph "Аналитика ва ҳисоботлар"
        RTD[Реал вақт маълумотлари<br/>- Навбат чуқурлиги<br/>- Қайта ишлаш тезлиги<br/>- Хато сонлари]
        AGG[Йиғилган статистика<br/>- Кунлик ҳисоботлар<br/>- Ойлик хулосалар<br/>- Тенденция таҳлили]
        INS[Тушунчалар<br/>- Қоидабузарлик намуналари<br/>- Фойдаланувчи хулқи<br/>- Тизим иш самарадорлиги]
    end

    %% Асосий оқим уланишлари
    VR --> VU
    MD --> VU
    VU --> VOrig
    VU --> TG
    TG --> IMG
    
    VU --> EQ
    EQ --> ES
    ES --> VEnc
    ES --> DQ
    DQ --> DS
    DS --> VDet
    DS --> RD
    
    RD --> VI
    VI --> DM
    DM -->|Қабул| ASF
    DM -->|Рад| WH
    
    ASF --> ASI
    ASI --> ASBT[ASBT тизими]
    ASI --> WH
    
    DM -->|Мукофот| RC
    RC --> PQ
    PQ --> PD
    PD --> Citizens[Фуқаролар]
    
    %% Сақлаш уланишлари
    VU --> RData
    VI --> VData
    PD --> TData
    Citizens -.-> UD
    
    %% Кеш уланишлари
    VU -.-> CAC
    EQ -.-> QST
    DQ -.-> QST
    
    %% Аналитика уланишлари
    QST --> RTD
    RData --> AGG
    VData --> AGG
    TData --> AGG
    AGG --> INS
    
    %% Webhook оқимлари
    WH --> TPApps[Учинчи томон иловалари]
    
    %% Стиллаштириш
    classDef capture fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef processing fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    classDef ai fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef review fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    classDef integration fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef payment fill:#fff9c4,stroke:#f9a825,stroke-width:2px
    classDef storage fill:#efebe9,stroke:#4e342e,stroke-width:2px
    classDef analytics fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    
    class VR,MD capture
    class VU,TG processing
    class EQ,ES,DQ,DS ai
    class RD,VI,DM review
    class ASF,ASI,WH integration
    class RC,PQ,PD payment
    class UD,RData,VData,TData,VOrig,VEnc,VDet,IMG,SES,CAC,QST storage
    class RTD,AGG,INS analytics
```

## Маълумотларни қайта ишлаш босқичлари

### 1. Маълумотларни ушлаш босқичи
**Кириш маълумотлари**:
- **Видео**: 2-120 сонияли клиплар, турли форматлар
- **Жойлашув**: Аниқлик билан GPS координаталари
- **Вақт белгиси**: Қоидабузарликнинг аниқ вақти
- **Қурилма маълумоти**: Телефон модели, илова версияси
- **Фойдаланувчи контексти**: Фуқаро ID, ташкилот билан боғлиқлик

**Маълумотлар ҳажми**: Кунига ~2,000-3,000 ҳисобот

### 2. Дастлабки қайта ишлаш
**Текшириш қадамлари**:
- Формат мослашувчанлигини текшириш
- Видео давомийлигини текшириш (максимум 120 сония)
- Файл ҳажми чегаралари (мобил юклаш учун мақбул)
- Такрорланишни аниқлаш (бир нечта ҳисоботларни олдини олиш)

**Чиқиш**: Маълумотлар базасида яратилган ҳақиқий ҳисобот

### 3. AI қайта ишлаш қувури
**Кодлаш жараёни**:
- **Кириш**: Асл видео (турли форматлар)
- **Қайта ишлаш**: Изчил форматга стандартлаштириш
- **Сиқиш**: 60% ҳажмни камайтириш
- **Чиқиш**: Аниқлаш учун оптималлаштирилган видео
- **Иш самарадорлиги**: Ўртача 30 сония

**Аниқлаш жараёни**:
- **Кириш**: Кодланган видео
- **AI таҳлили**: 
  - Қоидабузарлик турини аниқлаш
  - Рақам белгисини таниш
  - Ишонч баллари
- **Чиқиш**: Аниқлаш натижалари билан изоҳланган видео
- **Аниқлик**: 95% аниқлаш даражаси

### 4. Инсон кўриб чиқиши
**Кўриб чиқиш маълумотлари тақдимоти**:
- Асл ва қайта ишланган видеолар
- AI аниқлаш натижалари
- Транспорт воситаси учун тарихий маълумотлар
- Ўхшаш қоидабузарлик намуналари

**Қарор маълумотлари ушланиши**:
- Тасдиқланган рақам белгиси
- Танланган қоидабузарлик моддаси
- Далил вақт белгилари
- Инспектор изоҳлари

### 5. Интеграция қатлами
**ASBT маълумотлар пакети**:
```json
{
  "violation_id": "uuid",
  "license_plate": "01A234BC",
  "article_code": "1234",
  "evidence": {
    "video_url": "secure_link",
    "images": ["base64_encoded"],
    "timestamp": "2024-01-01T12:00:00Z",
    "location": {"lat": 41.123, "lng": 69.456}
  },
  "inspector_id": "uuid",
  "confidence": 0.95
}
```

**Webhook воқеалари**:
- Ҳисобот яратилди
- Ҳолат ўзгарди
- Қоидабузарлик қабул/рад этилди
- Тўлов қайта ишланди

### 6. Тўлов қайта ишлаш
**Мукофот ҳисоблаш маълумотлари**:
- Ҳар бир модда учун асосий миқдор
- Кўпайтириш омиллари
- Кунлик/ойлик чегаралар
- Фойдаланувчига олдинги мукофотлар

**Тўлов пакети маълумотлари**:
- Провайдер бўйича гуруҳланган
- Устуворлик бўйича тартибланган
- Қайта уриниш маълумотини ўз ичига олади
- Транзакция ҳавола

## Маълумотларни сақлаш стратегияси

### PostgreSQL (Транзакцион маълумотлар)
- **Фойдаланувчи маълумотлари**: 250,000+ фуқаро ёзувлари
- **Ҳисоботлар**: Жами 500,000+ ҳисобот
- **Қоидабузарликлар**: 1M+ қоидабузарлик ёзувлари
- **Транзакциялар**: Тўлиқ аудит изи

### MinIO (Объект сақлаш)
- **Сақлаш ҳажми**: Кластерлар бўйлаб кўп терабайт
- **Объект турлари**:
  - Асл видеолар
  - Кодланган видеолар
  - Аниқлаш натижаси видеолари
  - Миниатюралар ва далил тасвирлари
- **Сақлаш**: 24 ойлик сиёсат

### Redis (Кеш ва сессия)
- **Сессия маълумотлари**: Фаол фойдаланувчи сессиялари
- **Кеш**: Тез-тез фойдаланиладиган маълумотлар
- **Навбат ҳолати**: Реал вақтда қайта ишлаш ҳолати

## Маълумотлар оқими кўрсаткичлари

### Ҳажм кўрсаткичлари
- **Кунлик видео юкламалари**: 2-3 ТБ
- **Қайта ишлаш ўтказувчанлиги**: Кунига 5,000-10,000 видео
- **Сақлаш ўсиши**: Кунига ~100 ГБ
- **API чақирувлари**: Ойига 10M+

### Иш самарадорлиги кўрсаткичлари
- **Юклашдан натижагача**: Ўртача 2-5 дақиқа
- **Кўриб чиқиш вақти**: Ҳар бир қоидабузарлик учун 30 сония
- **ASBT синхронизацияси**: Деярли реал вақт
- **Тўлов қайта ишлаш**: 24-48 соат

### Сифат кўрсаткичлари
- **Маълумотлар аниқлиги**: 95% (AI + инсон кўриб чиқиши)
- **Қайта ишлаш муваффақияти**: 99.9%
- **Тўлов муваффақияти**: Биринчи уринишда 97%
- **Маълумотлар тўлиқлиги**: 100% аудит изи

## Маълумотлар хавфсизлиги ва конфиденциаллиги

### Маълумотларни ҳимоя қилиш
- **Шифрлаш**: Тинчлик ҳолатида ва транзитда
- **Кириш назорати**: Рол асосидаги рухсатлар
- **Анонимлаштириш**: Аналитика ва тадқиқот учун
- **Сақлаш чегаралари**: 24 ойдан кейин автоматик ўчириш

### Аудит изи
- Ҳар бир маълумот ўзгартириш рўйхатга олинган
- Фойдаланувчи ҳаракатлари кузатилади
- Тизим операциялари қайд қилинади
- Тўлиқ сақлаш занжири

## Маълумотларга асосланган тушунчалар

### Намуна аниқлаш
- Қоидабузарлик марказларини аниқлаш
- Вақтга асосланган қоидабузарлик намуналари
- Такрорий ҳуқуқбузарларни кузатиш
- Ижро самарадорлиги

### Операцион интеллект
- Навбат иш самарадорлигини оптималлаштириш
- Ресурслардан фойдаланиш намуналари
- Хато даражаси таҳлили
- Фойдаланувчи хулқи тушунчалари

### Сиёсат таъсири
- Қоидабузарлик тенденцияси таҳлили
- Ижро самарадорлиги кўрсаткичлари
- Хулқ-атвор ўзгариши кўрсаткичлари
- ROI ҳисоблари